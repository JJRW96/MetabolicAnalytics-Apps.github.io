<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="eng" xml:lang="eng"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Power Profile – ShinyApps</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Metabolic_Model_Apps/Power_Profile/Etalon_Calculator.html" rel="next">
<link href="../../Metabolic_Model_Apps/index_Metabolic_Model_Apps.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Metabolic_Model_Apps/index_Metabolic_Model_Apps.html">Metabolic Model Apps</a></li><li class="breadcrumb-item"><a href="../../Metabolic_Model_Apps/Power_Profile/Power_Profile.html">Power Profile</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/Logo_1.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Metabolic_Model_Apps/index_Metabolic_Model_Apps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metabolic Model Apps</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Metabolic_Model_Apps/Power_Profile/Power_Profile.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Power Profile</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Metabolic_Model_Apps/Power_Profile/Etalon_Calculator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Etalon Converter</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Metabolic_Model_Apps/Metabolic_Profile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metabolic Profile</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Metabolic_Model_Apps/Mader_Modell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise Simulation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Cycling_Apps/index_Cycling_Apps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cycling Apps</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Cycling_Apps/Cycling_Forces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cycling Forces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Cycling_Apps/CdA_App.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CdA Calculator</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Cadence_Test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cadence Tests</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Metabolic_Model_Apps/index_Metabolic_Model_Apps.html">Metabolic Model Apps</a></li><li class="breadcrumb-item"><a href="../../Metabolic_Model_Apps/Power_Profile/Power_Profile.html">Power Profile</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Power Profile</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
p {
  text-align: justify
}
caption, .figure-caption {
  text-align: left;
}
figure.quarto-float-tbl figcaption {
  text-align: left !important;
}
figure figcaption {
  text-align: justify;
}
</style>
</div>
<div style="position: relative; width: 100%; height: 800px;">
<p><iframe src="Power_Profile_App_2.8.html" style="position: absolute; width: 100%; height: 100%; border: none;"></iframe></p>
</div>
<p><br></p>
<p><a href="../..\Power_Profile_App_2.8.html">Fullscreen-Link: Power Profile Analyzer</a></p>
<section id="power-profile-analyzer-a-detailed-feature-guide" class="level1">
<h1>Power Profile Analyzer: A Detailed Feature Guide</h1>
<p>The <strong>Composite Power Profile Analyzer</strong> is a sophisticated, web-based tool designed for the in-depth analysis of cycling performance data. Its primary function is to process raw activity files (from sources like FIT, TCX, or GPX) and transform them into a comprehensive and actionable power profile. The application serves as a crucial “top-down” analytical engine, starting with an athlete’s real-world performance data to model their maximal power-duration capabilities.</p>
<p>The core workflow of the application can be broken down into several key stages:</p>
<ol type="1">
<li><strong>Data Aggregation and Parsing:</strong> The app can ingest multiple activity files from different training sessions or races. It parses these files to extract the fundamental time-stamped power data.</li>
<li><strong>Mean Maximal Power (MMP) Curve Generation:</strong> For each individual file, the app calculates the Mean Maximal Power (MMP) curve, which represents the highest average power achieved for every possible duration within that activity.</li>
<li><strong>Composite Profile Synthesis:</strong> The app’s key innovation is its ability to create a single, “best-ever” composite power curve by taking the peak MMP value for each duration across <em>all</em> uploaded files. This composite profile represents the athlete’s absolute best performance capabilities based on the provided data.</li>
<li><strong>Power-Duration Modeling:</strong> The composite curve is then fitted with a selection of established mathematical models (e.g., 2-Parameter Critical Power, OmPD, Power-Law) to derive key performance parameters like Critical Power (CP) and W’.</li>
<li><strong>Key Effort Identification and Refinement:</strong> A powerful algorithm automatically identifies “breakthrough” performances—points on the curve that significantly exceed the model’s prediction. This curated list can be further refined by the user.</li>
<li><strong>Profile Export:</strong> The final, refined profile (either the full composite curve or just the key efforts) can be exported as a <code>.json</code> file, specifically formatted for seamless import into metabolic modeling applications, such as the <em>Integrated Metabolic &amp; Power Profile</em> app.</li>
</ol>
<p>This tool is invaluable for athletes and coaches who wish to build a robust and accurate picture of their power profile from a wealth of training data, moving beyond the limitations of single-session analysis.</p>
<section id="the-sidebar-the-control-center" class="level2">
<h2 class="anchored" data-anchor-id="the-sidebar-the-control-center">The Sidebar: The Control Center</h2>
<p>The sidebar is the primary interface for controlling the entire analysis workflow, organized into logical tabs that guide the user from file upload to final export.</p>
<section id="tab-1-analysis-settings" class="level3">
<h3 class="anchored" data-anchor-id="tab-1-analysis-settings">Tab 1: Analysis &amp; Settings</h3>
<p>This is the main control panel for data input, athlete configuration, and model selection.</p>
<section id="upload-activity-files" class="level4">
<h4 class="anchored" data-anchor-id="upload-activity-files"><strong>1. Upload Activity Files</strong></h4>
<p>This section handles the initial data ingestion.</p>
<ul>
<li><strong>File Drop Area:</strong> Users can drag and drop multiple activity files or click to open a file selection dialog. The app supports three common formats:
<ul>
<li><strong><code>.fit</code> (Flexible and Interoperable Data Transfer):</strong> The standard format for modern Garmin devices and many other GPS computers. It is a binary format that the app parses using the <code>fit-file-parser.js</code> library.</li>
<li><strong><code>.tcx</code> (Training Center XML):</strong> An XML-based format that also contains detailed workout data, including power.</li>
<li><strong><code>.gpx</code> (GPS Exchange Format):</strong> An XML-based format primarily for GPS tracks, but it can contain power data within its <code>&lt;extensions&gt;</code> tags, which the app is equipped to parse.</li>
</ul></li>
<li><strong>Analysis Process:</strong> Once files are uploaded, the app performs a multi-step analysis “under the hood”:
<ol type="1">
<li><strong>Parsing:</strong> Each file is read and the raw, time-stamped power data points are extracted.</li>
<li><strong>Interpolation:</strong> The raw data, which may have variable recording intervals, is interpolated to a consistent 1-second resolution. This ensures that the subsequent MMP calculation is accurate and standardized.</li>
<li><strong>MMP Calculation:</strong> For each individual activity file, the app calculates the Mean Maximal Power (MMP) curve. This is achieved using a sliding window algorithm: for every duration <em>d</em> (from 1 second up to the total activity duration), the algorithm slides a window of size <em>d</em> across the 1-second power data array, calculating the average power for each window position. The highest average found for that duration <em>d</em> becomes the MMP value for that duration.</li>
<li><strong>Composite Curve Synthesis:</strong> After calculating the MMP curve for every uploaded file, the app creates the final composite power curve. For each second of duration (e.g., 1s, 2s, …, 3600s, etc.), it compares the MMP value from all the individual files and retains only the single highest value. The result is a single curve representing the athlete’s absolute best performance across all provided activities.</li>
</ol></li>
<li><strong>Show Key Efforts (Checkbox):</strong> This toggle controls the visibility of “Key Effort” markers on the main plot. These markers highlight significant “breakthrough” performances. The logic for their selection is based on a comparison between the athlete’s actual composite curve and the power predicted by the fitted mathematical model:
<ul>
<li><strong>Selection Logic:</strong> The app divides the power curve into time “buckets” (e.g., 1-3 min, 5-10 min, etc.). Within each bucket, it identifies the data point that has the highest <em>positive</em> percentage deviation from the fitted model line.</li>
<li><strong>Special Rule:</strong> For critical endurance ranges (e.g., around the 5 to 60-minute mark), if no data point lies <em>above</em> the model’s prediction, the algorithm pragmatically selects the point with the <em>smallest negative</em> deviation. This ensures that even in a well-modeled profile, a representative point is chosen for these important durations.</li>
<li><strong>Protected Efforts:</strong> The maximal power for 1 second and 20 seconds are always identified and protected as key efforts, given their physiological significance for neuromuscular and glycolytic power.</li>
</ul></li>
</ul>
</section>
<section id="athlete-unit-settings" class="level4">
<h4 class="anchored" data-anchor-id="athlete-unit-settings"><strong>2. Athlete &amp; Unit Settings</strong></h4>
<p>This section allows for personalization and sets the units for display.</p>
<ul>
<li><strong>Gender, Age, Height:</strong> These anthropometric details are primarily collected for compatibility when exporting the profile for use in other applications that may require them for metabolic calculations (like the <em>Integrated Metabolic &amp; Power Profile</em> app).</li>
<li><strong>Body Mass (kg):</strong> A critical input. This value is used to calculate and display mass-relative power (in W/kg) if the user chooses.</li>
<li><strong>Global Power Unit (Toggle):</strong> This switch (<code>Use Absolute Units (W)</code>) determines how power data is displayed throughout the application—on the plot’s Y-axis, in the summary tables, and in the data lists. When checked, all values are in absolute Watts (W). When unchecked, values are in Watts per kilogram (W·kg⁻¹). This setting only affects visualization; the underlying model fitting is handled internally to ensure consistency.</li>
</ul>
</section>
<section id="power-duration-model-plot" class="level4">
<h4 class="anchored" data-anchor-id="power-duration-model-plot"><strong>3. Power-Duration Model &amp; Plot</strong></h4>
<p>This section configures the mathematical modeling and visualization of the composite power curve.</p>
<ul>
<li><strong>Power-Duration Model (Dropdown):</strong> Selects the model to be fitted to the composite power data. The options are the same as in the metabolic app:
<ul>
<li><strong>2-Parameter CP (Hyperbolic):</strong> The classic model where power is the sum of a sustainable component (CP) and an unsustainable component (W’) that depletes over time <span class="citation" data-cites="Monod1965">(<a href="#ref-Monod1965" role="doc-biblioref">Monod &amp; Scherrer, 1965</a>)</span>. <span class="math display">\[ P(t) = CP + \frac{W'}{t} \]</span>
<ul>
<li><strong>Pros:</strong> Well-established; the parameters are physiologically interpretable (CP as a metabolic threshold, W’ as anaerobic work capacity).</li>
<li><strong>Cons:</strong> Unrealistic for very short durations (predicts infinite power as t→0) and very long durations (predicts no fatigue below CP).</li>
<li><strong>Data:</strong> Best suited for efforts in the “severe” intensity domain, typically from 2 to 20 minutes. Requires 3-5 reliable data points for a robust fit <span class="citation" data-cites="Leo2022">(<a href="#ref-Leo2022" role="doc-biblioref">Leo et al., 2022</a>)</span>.</li>
</ul></li>
<li><strong>Omni-Domain (OmPD):</strong> A 4-parameter extension of the 2P-CP model, designed for a more realistic fit across a wider range of durations, including prolonged endurance <span class="citation" data-cites="Puchowicz2020">(<a href="#ref-Puchowicz2020" role="doc-biblioref">Puchowicz et al., 2020</a>)</span>. It adds a maximal power parameter (<span class="math inline">\(P_{max}\)</span>) to anchor the short end of the curve and a fatigue parameter (A) to model the performance decline during very long efforts. <span class="math display">\[ P(t) =
\begin{cases}
\frac{W'_{\text{eff}}(t)}{t} + CP &amp; \text{if } t \le 1800s \\
\frac{W'_{\text{eff}}(t)}{t} + CP - A \cdot \ln(\frac{t}{1800}) &amp; \text{if } t &gt; 1800s
\end{cases}
\]</span> Where <span class="math inline">\(W'_{\text{eff}}(t) = W' \cdot (1 - e^{-t/\tau})\)</span> and <span class="math inline">\(\tau = W' / (P_{max} - CP)\)</span>.
<ul>
<li><strong>Pros:</strong> Aims to model the entire power curve, from sprints to ultra-endurance.</li>
<li><strong>Cons:</strong> More complex; requires more data points (≥4, including efforts &gt;30 min) for a stable fit.</li>
<li><strong>Virtual Points:</strong> To improve stability, the app automatically adds a virtual 20s data point (based on the “Best 20s Avg. Power” input) if no real data exists in the 1-35s range when this model is selected.</li>
</ul></li>
<li><strong>Power-Law:</strong> A simple, robust 2-parameter model where power is a power function of time. <span class="math display">\[ P(t) = S \cdot t^{E-1} \]</span>
<ul>
<li><strong>Pros:</strong> Often provides an excellent mathematical fit across all durations with as few as two data points.</li>
<li><strong>Cons:</strong> The parameters (S and E) are less directly interpretable as physiological thresholds compared to CP and W’.</li>
</ul></li>
</ul></li>
<li><strong>Customize Fitting Range (Toggle &amp; Sliders):</strong> This allows the user to precisely control which portion of the composite power curve is used for the model fitting. By adjusting the “Fitting Start (s)” and “Fitting End (s)” sliders, a user can, for example, focus the fit of a 2P-CP model on the 2-20 minute range to get a more robust CP value, or use the entire curve for a Power-Law model.</li>
<li><strong>Customize Plot X-Axis (Toggle &amp; Sliders):</strong> These controls adjust the visible time range of the main plot’s X-axis <em>without</em> affecting the data or the model fit. It is purely a visualization tool for zooming in on specific sections of the power curve (e.g., focusing on sprint performance from 0-60 seconds).</li>
</ul>
</section>
<section id="export-profile" class="level4">
<h4 class="anchored" data-anchor-id="export-profile"><strong>4. Export Profile</strong></h4>
<p>This is the final output stage of the application.</p>
<ul>
<li><strong>Profile Name:</strong> A text input field allowing the user to assign a descriptive name to the exported profile (e.g., “Pogi - Stage 1”).</li>
<li><strong>Clean Up Key Efforts (Button):</strong> This triggers a sophisticated algorithm designed to refine the list of automatically-identified key efforts, removing redundant points to create a more balanced and representative set for export. The algorithm works as follows:
<ol type="1">
<li><strong>Protect:</strong> The 1s and 20s efforts are always kept.</li>
<li><strong>Filter:</strong> Efforts that fall significantly below the model’s prediction (e.g., deviation &lt; -3%) are removed.</li>
<li><strong>Winner-Takes-All:</strong> The remaining efforts are sorted by their “quality” (i.e., their positive deviation from the model). The algorithm iterates through this sorted list. The highest-quality effort is selected and “claims” a surrounding time window. The size of this window is dynamic: it’s wider for longer-duration efforts (e.g., +/- 20% for efforts &gt;30 min) and narrower for shorter ones (e.g., +/- 50% for efforts &lt;1 min). Any other efforts falling within the winner’s claimed window are discarded. This process repeats until all efforts have either been selected as a winner or discarded, ensuring the final list is well-distributed across the time spectrum.</li>
</ol></li>
<li><strong>Export Key Efforts Profile (Button):</strong> Exports a <code>.json</code> file containing only the curated list of key efforts. This is the recommended export format for use in metabolic modeling, as it provides a set of high-quality, non-redundant maximal efforts.</li>
<li><strong>Export Full Profile (Button):</strong> Exports a <code>.json</code> file containing the <em>entire</em> composite power curve (MMP data for every second).</li>
</ul>
</section>
</section>
<section id="tab-2-composite-power-data" class="level3">
<h3 class="anchored" data-anchor-id="tab-2-composite-power-data">Tab 2: Composite Power Data</h3>
<p>This tab provides a simple, scrollable list of the entire composite Mean Maximal Power curve, showing the duration and the corresponding maximal power value for every second of the profile. Users can manually remove individual data points from this list, which will trigger a refit of the power-duration model.</p>
</section>
<section id="tab-3-key-efforts" class="level3">
<h3 class="anchored" data-anchor-id="tab-3-key-efforts">Tab 3: Key Efforts</h3>
<p>This tab, which appears after the first analysis, displays only the curated list of key efforts identified by the app’s algorithm. It provides the same functionality as the “Composite Power Data” tab, allowing users to inspect and manually remove points from this specific list before exporting. This is the primary interface for refining the profile that will be used in other modeling tools.</p>
</section>
</section>
<section id="the-main-content-area-visualizations-outputs" class="level2">
<h2 class="anchored" data-anchor-id="the-main-content-area-visualizations-outputs">The Main Content Area: Visualizations &amp; Outputs</h2>
<p>This is where the results of the analysis are graphically and numerically presented.</p>
<section id="power-duration-profile-plot" class="level4">
<h4 class="anchored" data-anchor-id="power-duration-profile-plot"><strong>Power-Duration Profile Plot</strong></h4>
<p>This is the central visualization of the application.</p>
<ul>
<li><strong>Composite Curve (Light Grey Line with Markers):</strong> The full Mean Maximal Power curve derived from all uploaded files. The markers on this line are color-coded based on their percentage deviation from the fitted model curve, providing an immediate visual assessment of the model’s fit. Colors typically range from cool (e.g., blue, for points far below the model) to hot (e.g., red, for points far above the model).</li>
<li><strong>Fitted Model (Dark Grey Line):</strong> The selected mathematical model (e.g., OmPD) is overlaid on the data. It is drawn as a solid line within the user-defined fitting range and as a dashed line where it is extrapolated.</li>
<li><strong>Key Efforts (Star Markers):</strong> The identified “breakthrough” efforts are highlighted with large, distinct star markers, making them easy to identify. These markers are also color-coded by their deviation.</li>
<li><strong>Annotations:</strong> A text box on the plot provides a detailed summary of the fitted model, including its name, the derived parameters (CP, W’, S, E, etc.), and the R² value indicating the goodness of fit.</li>
</ul>
</section>
<section id="values-container" class="level4">
<h4 class="anchored" data-anchor-id="values-container"><strong>Values Container</strong></h4>
<p>This text area below the plot provides a concise numerical summary of the analysis.</p>
<ul>
<li><strong>Model Parameters:</strong> It lists the key parameters derived from the fitted model, such as Critical Power (CP) and W’, providing both absolute (W, kJ) and relative (W/kg, kJ/kg) values.</li>
<li><strong>MMP Table:</strong> It displays a table of the maximal mean power values from the composite curve for standard, physiologically relevant durations (e.g., 1s, 15s, 1min, 5min, 20min, 60min), giving a quick performance overview.</li>
</ul>


</section>
</section>
</section>
<section id="bibliography" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Brooks2012" class="csl-entry" role="listitem">
Brooks, G. A. (2012). <span class="nocase">Bioenergetics of exercising humans.</span> <em>Comprehensive Physiology</em>, <em>2</em>(1), 537–562. <a href="https://doi.org/10.1002/cphy.c110007">https://doi.org/10.1002/cphy.c110007</a>
</div>
<div id="ref-Brooks2004" class="csl-entry" role="listitem">
Brooks, G. A., Fahey, T. D., &amp; Baldwin, K. M. (2004). <em><span class="nocase">Exercise Physiology: Human Bioenergetics and Its Applications</span></em> (4. Edition, p. 928). McGraw-Hill Education Ltd.
</div>
<div id="ref-Dunst2024" class="csl-entry" role="listitem">
Dunst, A. K., Hesse, C., &amp; Ueberschär, O. (2024). <span class="nocase">Understanding optimal cadence dynamics: a systematic analysis of the power-velocity relationship in track cyclists with increasing exercise intensity</span>. <em>Frontiers in Physiology</em>, <em>15</em>(April), 1–17. <a href="https://doi.org/10.3389/fphys.2024.1343601">https://doi.org/10.3389/fphys.2024.1343601</a>
</div>
<div id="ref-Dunst2025" class="csl-entry" role="listitem">
Dunst, A. K., Hesse, C., &amp; Ueberschär, O. (2025). <span class="nocase">Enhancing endurance performance predictions: the role of movement velocity in metabolic simulations demonstrated by cycling cadence.</span> <em>European Journal of Applied Physiology</em>. <a href="https://doi.org/10.1007/s00421-024-05663-4">https://doi.org/10.1007/s00421-024-05663-4</a>
</div>
<div id="ref-Friedlander1998" class="csl-entry" role="listitem">
Friedlander, A. L., Casazza, G. A., Horning, M. A., Buddinger, T. F., &amp; Brooks, G. A. (1998). <span class="nocase">Effects of exercise intensity and training on lipid metabolism in young women</span>. <em>American Journal of Physiology - Endocrinology and Metabolism</em>, <em>275</em>(5 38-5), 853–863. <a href="https://doi.org/10.1152/ajpendo.1998.275.5.e853">https://doi.org/10.1152/ajpendo.1998.275.5.e853</a>
</div>
<div id="ref-Friedlander1999" class="csl-entry" role="listitem">
Friedlander, A. L., Casazza, G. A., Horning, M. A., Usaj, A., &amp; Brooks, G. A. (1999). <span class="nocase">Endurance training increases fatty acid turnover, but not fat oxidation, in young men</span>. <em>Journal of Applied Physiology</em>, <em>86</em>(6), 2097–2105. <a href="https://doi.org/10.1152/jappl.1999.86.6.2097">https://doi.org/10.1152/jappl.1999.86.6.2097</a>
</div>
<div id="ref-Hauser2014" class="csl-entry" role="listitem">
Hauser, T., Adam, J., &amp; Schulz, H. (2014). <span class="nocase">Comparison of calculated and experimental power in maximal lactate-steady state during cycling</span>. <em>Theoretical Biology and Medical Modelling</em>, <em>11</em>(1), 1–12. <a href="https://doi.org/10.1186/1742-4682-11-25">https://doi.org/10.1186/1742-4682-11-25</a>
</div>
<div id="ref-Hintzy-Cloutier2003" class="csl-entry" role="listitem">
Hintzy-Cloutier, F., Zameziati, K., &amp; Belli, A. (2003). <a href="https://www.ncbi.nlm.nih.gov/pubmed/12629462"><span class="nocase">Influence of the base-line determination on work efficiency during submaximal cycling</span></a>. <em>Journal of Sports Medicine and Physical Fitness</em>, <em>43</em>(1), 51–56.
</div>
<div id="ref-Jeukendrup2005" class="csl-entry" role="listitem">
Jeukendrup, A. E., &amp; Wallis, G. A. (2005). <em><span class="nocase">Measurement of substrate oxidation during exercise by means of gas exchange measurements</span></em> (No. 1; Vol. 26). <a href="https://doi.org/10.1055/s-2004-830512">https://doi.org/10.1055/s-2004-830512</a>
</div>
<div id="ref-Jeukendrup2019" class="csl-entry" role="listitem">
Jeukendrup, A., &amp; Gleeson, M. (2019). <em><span>Sport Nutrition</span></em> (3. Edition, p. 602). Human Kinetics.
</div>
<div id="ref-Ji2021" class="csl-entry" role="listitem">
Ji, S., Sommer, A., Bloch, W., &amp; Wahl, P. (2021). <span class="nocase">Comparison and performance validation of calculated and established anaerobic lactate thresholds in running</span>. <em>Medicina (Lithuania)</em>, <em>57</em>(10). <a href="https://doi.org/10.3390/medicina57101117">https://doi.org/10.3390/medicina57101117</a>
</div>
<div id="ref-Leo2022" class="csl-entry" role="listitem">
Leo, P., Spragg, J., Wakefield, J., &amp; Swart, J. (2022). <span class="nocase">The Compound Score in elite road cycling</span>. <em>Conference Paper</em>, 1–5.
</div>
<div id="ref-Mader1984" class="csl-entry" role="listitem">
Mader, A. (1984). <em><span class="nocase">Eine Theorie zur Berechnung der Dynamik und des steady state von Phosphorylierungszustand und Stoffwechselaktivit<span class="nocase">ä</span>t der Muskelzelle als Folge des Energeibedarfs</span></em> (p. 264) [PhD thesis]. Deutsche Sporthochschule K<span>ö</span>ln.
</div>
<div id="ref-Mader2003" class="csl-entry" role="listitem">
Mader, A. (2003). <span class="nocase">Glycolysis and oxidative phosphorylation as a function of cytosolic phosphorylation state and power output of the muscle cell</span>. <em>European Journal of Applied Physiology</em>, <em>88</em>(4-5), 317–338. <a href="https://doi.org/10.1007/s00421-002-0676-3">https://doi.org/10.1007/s00421-002-0676-3</a>
</div>
<div id="ref-Mader1996" class="csl-entry" role="listitem">
Mader, A., &amp; Allmer, H. (1996). <em><span class="nocase">Computersimulation: M<span class="nocase">ö</span>glichkeiten zur Theoriebildung und Ergebnisinterpretation</span></em> (p. 170). <a href="http://www.amazon.de/Computersimulation-M�glichkeiten-zur-Theoriebildung-Ergebnisinterpretation/dp/3883457310">http://www.amazon.de/Computersimulation-M�glichkeiten-zur-Theoriebildung-Ergebnisinterpretation/dp/3883457310</a>
</div>
<div id="ref-Mader1986" class="csl-entry" role="listitem">
Mader, A., &amp; Heck, H. (1986). <span class="nocase">A theory of the metabolic origin of anaerobic threshold.</span> <em>International Journal of Sports Medicine</em>, <em>7 (Suppl.</em>, 45–65.
</div>
<div id="ref-Monod1965" class="csl-entry" role="listitem">
Monod, H., &amp; Scherrer, J. (1965). <span class="nocase">The work capacity of a synergic muscular group</span>. <em>Ergonomics</em>, <em>8</em>(3), 329–338. <a href="https://doi.org/10.1080/00140136508930810">https://doi.org/10.1080/00140136508930810</a>
</div>
<div id="ref-Nolte2022" class="csl-entry" role="listitem">
Nolte, S., Quittmann, O. J., &amp; Meden, V. (2022). <span class="nocase">Simulation of Steady-State Energy Metabolism in Cycling and Running</span>. <em>SportR<span class="math inline">\(\chi\)</span>iv</em>.
</div>
<div id="ref-Oezyener2001" class="csl-entry" role="listitem">
Özyener, F., Rossiter, H. B., Ward, S. A., &amp; Whipp, B. J. (2001). <span class="nocase">Influence of exercise intensity on the on- and off-transient kinetics of pulmonary oxygen uptake in humans.</span> <em>The Journal of Physiology</em>, <em>533</em>(Pt 3), 891–902. <a href="https://doi.org/10.1111/j.1469-7793.2001.t01-1-00891.x">https://doi.org/10.1111/j.1469-7793.2001.t01-1-00891.x</a>
</div>
<div id="ref-Puchowicz2020" class="csl-entry" role="listitem">
Puchowicz, M. J., Baker, J., &amp; Clarke, D. C. (2020). <span class="nocase">Development and field validation of an omni-domain power-duration model</span>. <em>Journal of Sports Sciences</em>, <em>38</em>(7), 801–813. <a href="https://doi.org/10.1080/02640414.2020.1735609">https://doi.org/10.1080/02640414.2020.1735609</a>
</div>
<div id="ref-Stegemann1991" class="csl-entry" role="listitem">
Stegemann, J. (1991). <em><span>Leistungsphysiologie</span></em> (4. Edition, p. 385). Georg Thieme Verlag.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Metabolic_Model_Apps/index_Metabolic_Model_Apps.html" class="pagination-link" aria-label="Metabolic Model Apps">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Metabolic Model Apps</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Metabolic_Model_Apps/Power_Profile/Etalon_Calculator.html" class="pagination-link" aria-label="Etalon Converter">
        <span class="nav-page-text">Etalon Converter</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Johannes Will, 2025 | <a href="mailto:JohannesWill96@gmail.com">JohannesWill96@gmail.com</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>